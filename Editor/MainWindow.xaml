<Window x:Class="Editor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Editor"
        xmlns:scene="clr-namespace:Engine.Data.Scene;assembly=Engine"
        xmlns:common="clr-namespace:Engine.Common;assembly=Engine"
        Title="PaCEngine Editor" Height="720" Width="1280">
    <Window.Resources>

        <local:KindEqualsToVisibilityConverter x:Key="KindToVisibility"/>

        <!-- Inspector-Template: Scene -->
        <DataTemplate DataType="{x:Type scene:SceneDTO}">
            <StackPanel Margin="8" Grid.IsSharedSizeScope="True">
                <TextBlock Text="Scene" FontWeight="Bold" Margin="0 0 0 8" />
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140" SharedSizeGroup="label"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Id:" VerticalAlignment="Center" />
                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Id, UpdateSourceTrigger=PropertyChanged}" LostFocus="SceneId_LostFocus" />

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Background Path:" VerticalAlignment="Center" />
                    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding BackgroundPath, UpdateSourceTrigger=PropertyChanged}" />

                    <!-- Walkmask/StartPosition absichtlich NICHT anzeigen (kommt später neu) -->

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Music Cue Id:" VerticalAlignment="Center" />
                    <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding MusicCueId, UpdateSourceTrigger=PropertyChanged}" />
                </Grid>
            </StackPanel>
        </DataTemplate>

        <!-- Inspector-Template: Hotspot -->
        <DataTemplate DataType="{x:Type scene:HotspotDTO}">
            <StackPanel Margin="8" Grid.IsSharedSizeScope="True">
                <TextBlock Text="Hotspot" FontWeight="Bold" Margin="0 0 0 8" />
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140" SharedSizeGroup="label"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Id:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Id, UpdateSourceTrigger=PropertyChanged}" LostFocus="HotspotId_LostFocus" />

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Label Key:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding LabelKey, UpdateSourceTrigger=PropertyChanged}" />

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Event Path Id:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding EventPathId, UpdateSourceTrigger=PropertyChanged}" />

                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Cursor Id:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding CursorId, UpdateSourceTrigger=PropertyChanged}" />

                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Highlight:" VerticalAlignment="Center"/>
                    <CheckBox Grid.Row="4" Grid.Column="1" IsChecked="{Binding Highlight, UpdateSourceTrigger=PropertyChanged}"/>

                    <GroupBox Grid.Row="5" Grid.ColumnSpan="2" Header="Rect" Margin="0,8,0,0">
                        <Grid Margin="8">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="X:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Rect.X, UpdateSourceTrigger=PropertyChanged}" />

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Y:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Rect.Y, UpdateSourceTrigger=PropertyChanged}" />

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="W:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Rect.Width, UpdateSourceTrigger=PropertyChanged}" />

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="H:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding Rect.Height, UpdateSourceTrigger=PropertyChanged}" />
                        </Grid>
                    </GroupBox>
                </Grid>
                <Button Content="Delete Hotspot"
                    Margin="0,12,0,0"
                    HorizontalAlignment="Left"
                    Padding="12,6"
                    Background="#993a1a1a"
                    Foreground="White"
                    Click="DeleteHotspot_Click"
                    Tag="{Binding}" />
            </StackPanel>
        </DataTemplate>

    </Window.Resources>

    <DockPanel>
        <!-- Menü -->
        <Menu DockPanel.Dock="Top">
            <!-- File -->
            <MenuItem Header="_File">
                <MenuItem Header="_Open Scene..." Click="OpenSceneMenu_Click" />
                <Separator />
                <MenuItem Header="_Save" Click="SaveSceneMenu_Click" InputGestureText="Ctrl+S"/>
                <MenuItem Header="Save _As..." Click="SaveSceneAsMenu_Click"/>
                <Separator />
                <MenuItem Header="E_xit" Click="ExitMenu_Click" />
            </MenuItem>
            <!-- Hotspots -->
            <MenuItem Header="_Scene">
                <MenuItem Header="Add _Hotspot" Click="AddHotspotMenu_Click" />
            </MenuItem>
            <MenuItem Header="_Tools">
                <MenuItem Header="_Validate Scene" Click="ValidateSceneMenu_Click"/>
                <Separator />
                <MenuItem Header="_Log Viewer..." Click="LogViewerMenu_Click"/>
            </MenuItem>
        </Menu>

        <!-- Statusbar -->
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem>
                <TextBlock x:Name="StatusText" Text="Ready." />
            </StatusBarItem>
        </StatusBar>

        <!-- Hauptbereich -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <!-- Hierarchy -->
                <ColumnDefinition Width="*"/>
                <!-- Center (Viewport-Placeholder) -->
                <ColumnDefinition Width="360"/>
                <!-- Inspector -->
            </Grid.ColumnDefinitions>

            <!-- Hierarchy (links) -->
            <Border Grid.Column="0" BorderBrush="#333" BorderThickness="0,0,1,0">
                <TreeView x:Name="HierarchyTree"
          SelectedItemChanged="HierarchyTree_SelectedItemChanged"
          PreviewMouseRightButtonDown="HierarchyTree_PreviewMouseRightButtonDown">
                    <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                            <StackPanel Orientation="Horizontal">
                                <StackPanel.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Add Hotspot"
                      Visibility="{Binding Kind, Converter={StaticResource KindToVisibility}, ConverterParameter=HotspotGroup}"
                      Click="CtxAddHotspot_Click"/>
                                        <MenuItem Header="Delete Hotspot"
                      Visibility="{Binding Kind, Converter={StaticResource KindToVisibility}, ConverterParameter=Hotspot}"
                      Click="CtxDeleteHotspot_Click"/>
                                    </ContextMenu>
                                </StackPanel.ContextMenu>
                                <TextBlock Text="{Binding Name}" />
                            </StackPanel>
                        </HierarchicalDataTemplate>
                    </TreeView.ItemTemplate>
                </TreeView>
            </Border>

            <!-- Center: Platzhalter für Viewport (später) -->
            <Grid Grid.Column="1">
                <TextBlock Text="Viewport (coming soon…)" HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0.4"/>
            </Grid>

            <!-- Inspector (rechts) -->
            <Border Grid.Column="2" BorderBrush="#333" BorderThickness="1,0,0,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <ContentControl x:Name="InspectorHost" />
                </ScrollViewer>
            </Border>
        </Grid>
    </DockPanel>
</Window>
